<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Transfer Entropy Analysis and Causal Discovery • ManyIVsNets</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Transfer Entropy Analysis and Causal Discovery">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ManyIVsNets</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/instrument_creation.html">Creating Multidimensional Instruments from Scratch</a></li>
    <li><a class="dropdown-item" href="../articles/introduction.html">Introduction to ManyIVsNets</a></li>
    <li><a class="dropdown-item" href="../articles/network_visualization.html">Network Analysis and Visualization Guide</a></li>
    <li><a class="dropdown-item" href="../articles/transfer_entropy_analysis.html">Transfer Entropy Analysis and Causal Discovery</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/avishekb9/ManyIVsNets/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Transfer Entropy Analysis and Causal Discovery</h1>
                        <h4 data-toc-skip class="author">Avishek
Bhandari</h4>
            
            <h4 data-toc-skip class="date">2025-06-07</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/avishekb9/ManyIVsNets/blob/main/vignettes/transfer_entropy_analysis.Rmd" class="external-link"><code>vignettes/transfer_entropy_analysis.Rmd</code></a></small>
      <div class="d-none name"><code>transfer_entropy_analysis.Rmd</code></div>
    </div>

    
    
<pre><code><span><span class="fu">knitr</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/knitr/man/opts_chunk.html" class="external-link">opts_chunk</a></span><span class="op">$</span><span class="fu">set</span><span class="op">(</span></span>
<span>  collapse <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  comment <span class="op">=</span> <span class="st">"#&gt;"</span>,</span>
<span>  fig.width <span class="op">=</span> <span class="fl">12</span>,</span>
<span>  fig.height <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  warning <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  message <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  eval <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre>
<div class="section level2">
<h2 id="transfer-entropy-analysis-and-causal-discovery">Transfer Entropy Analysis and Causal Discovery<a class="anchor" aria-label="anchor" href="#transfer-entropy-analysis-and-causal-discovery"></a>
</h2>
<p>This vignette provides a comprehensive guide to ManyIVsNets’
implementation of transfer entropy analysis for causal discovery in
Environmental Phillips Curve research. Our analysis reveals important
causal relationships with network density of 0.095 and 4 significant
causal links among EPC variables.</p>
<div class="section level3">
<h3 id="what-is-transfer-entropy">What is Transfer Entropy?<a class="anchor" aria-label="anchor" href="#what-is-transfer-entropy"></a>
</h3>
<p>Transfer entropy is an information-theoretic measure that quantifies
the amount of information transferred from one time series to another,
providing a non-parametric approach to causal discovery. Unlike Granger
causality, transfer entropy can capture non-linear relationships and
does not assume specific functional forms.</p>
<p><strong>Mathematical Foundation:</strong></p>
<p>Transfer entropy from Y to X is defined as:</p>
<p>TE(Y→X) = H(X_{t+1}|X_t) - H(X_{t+1}|X_t, Y_t)</p>
<p>Where H denotes entropy, measuring the reduction in uncertainty about
X_{t+1} when we know both X_t and Y_t compared to knowing only X_t.</p>
</div>
<div class="section level3">
<h3 id="why-transfer-entropy-for-environmental-economics">Why Transfer Entropy for Environmental Economics?<a class="anchor" aria-label="anchor" href="#why-transfer-entropy-for-environmental-economics"></a>
</h3>
<p>Traditional approaches to environmental economics often assume linear
relationships and specific functional forms. Transfer entropy offers
several advantages:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Non-parametric approach</strong>: No assumptions about
functional form</li>
<li>
<strong>Non-linear relationship detection</strong>: Captures complex
environmental-economic interactions<br>
</li>
<li>
<strong>Directional causality</strong>: Identifies causal direction
between variables</li>
<li>
<strong>Network construction</strong>: Enables creation of causal
networks for instrument construction</li>
<li>
<strong>Robust to outliers</strong>: Information-theoretic measures
are less sensitive to extreme values</li>
</ol>
</div>
<div class="section level3">
<h3 id="variables-in-our-transfer-entropy-analysis">Variables in Our Transfer Entropy Analysis<a class="anchor" aria-label="anchor" href="#variables-in-our-transfer-entropy-analysis"></a>
</h3>
<p>Our analysis examines causal relationships among 7 key EPC
variables:</p>
<pre><code><span><span class="va">te_variables</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lnCO2"</span>, <span class="st">"lnUR"</span>, <span class="st">"lnURF"</span>, <span class="st">"lnURM"</span>, <span class="st">"lnPCGDP"</span>, <span class="st">"lnTrade"</span>, <span class="st">"lnRES"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">variable_descriptions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Variable <span class="op">=</span> <span class="va">te_variables</span>,</span>
<span>  Description <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"Log CO2 emissions per capita"</span>,</span>
<span>    <span class="st">"Log unemployment rate (total)"</span>,</span>
<span>    <span class="st">"Log female unemployment rate"</span>,</span>
<span>    <span class="st">"Log male unemployment rate"</span>,</span>
<span>    <span class="st">"Log per capita GDP"</span>,</span>
<span>    <span class="st">"Log trade openness"</span>,</span>
<span>    <span class="st">"Log renewable energy share"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  Type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Environmental"</span>, <span class="st">"Employment"</span>, <span class="st">"Employment"</span>, <span class="st">"Employment"</span>,</span>
<span>           <span class="st">"Economic"</span>, <span class="st">"Economic"</span>, <span class="st">"Energy"</span><span class="op">)</span>,</span>
<span>  Role <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Dependent"</span>, <span class="st">"Key Independent"</span>, <span class="st">"Control"</span>, <span class="st">"Control"</span>,</span>
<span>           <span class="st">"Control"</span>, <span class="st">"Control"</span>, <span class="st">"Control"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">variable_descriptions</span><span class="op">)</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="transfer-entropy-implementation">Transfer Entropy Implementation<a class="anchor" aria-label="anchor" href="#transfer-entropy-implementation"></a>
</h3>
<div class="section level4">
<h4 id="data-preparation">Data Preparation<a class="anchor" aria-label="anchor" href="#data-preparation"></a>
</h4>
<pre><code><span><span class="co"># Prepare time series data for transfer entropy analysis</span></span>
<span><span class="va">ts_data</span> <span class="op">&lt;-</span> <span class="va">enhanced_data</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">country</span>, <span class="va">year</span>, <span class="va">country_code</span>, <span class="fu">all_of</span><span class="op">(</span><span class="va">te_variables</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">arrange</span><span class="op">(</span><span class="va">country</span>, <span class="va">year</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/complete.cases.html" class="external-link">complete.cases</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Variables for TE analysis:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">te_variables</span>, collapse <span class="op">=</span> <span class="st">", "</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Complete cases for TE analysis:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">ts_data</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Countries in analysis:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">ts_data</span><span class="op">$</span><span class="va">country</span><span class="op">)</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Time period:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">ts_data</span><span class="op">$</span><span class="va">year</span><span class="op">)</span>, <span class="st">"-"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">ts_data</span><span class="op">$</span><span class="va">year</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span></code></pre>
<p><strong>Data Requirements:</strong> - <strong>Complete time
series</strong>: No missing values for TE calculation -
<strong>Sufficient observations</strong>: Minimum 8 observations per
country - <strong>Stationarity</strong>: Variables should be stationary
(log transformation helps) - <strong>Temporal ordering</strong>: Proper
time sequence for causal inference</p>
</div>
<div class="section level4">
<h4 id="enhanced-transfer-entropy-calculation">Enhanced Transfer Entropy Calculation<a class="anchor" aria-label="anchor" href="#enhanced-transfer-entropy-calculation"></a>
</h4>
<pre><code><span><span class="co"># Enhanced transfer entropy calculation with fallback</span></span>
<span><span class="va">calculate_te_enhanced</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/conditions.html" class="external-link">tryCatch</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="co"># Check data quality</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">8</span> <span class="op">||</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">8</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">complete_idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/complete.cases.html" class="external-link">complete.cases</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">complete_idx</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">6</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">x_clean</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="va">complete_idx</span><span class="op">]</span></span>
<span>    <span class="va">y_clean</span> <span class="op">&lt;-</span> <span class="va">y</span><span class="op">[</span><span class="va">complete_idx</span><span class="op">]</span></span>
<span>    </span>
<span>    <span class="co"># Check for sufficient variation</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">x_clean</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">0.01</span> <span class="op">||</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">y_clean</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">0.01</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># Use RTransferEntropy if available</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"RTransferEntropy"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">te_result</span> <span class="op">&lt;-</span> <span class="fu">RTransferEntropy</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RTransferEntropy/man/calc_te.html" class="external-link">calc_te</a></span><span class="op">(</span></span>
<span>        x <span class="op">=</span> <span class="va">x_clean</span>,</span>
<span>        y <span class="op">=</span> <span class="va">y_clean</span>,</span>
<span>        lx <span class="op">=</span> <span class="fl">1</span>,  <span class="co"># Lag length for x</span></span>
<span>        ly <span class="op">=</span> <span class="fl">1</span>,  <span class="co"># Lag length for y</span></span>
<span>        entropy <span class="op">=</span> <span class="st">"Shannon"</span>,</span>
<span>        bins <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x_clean</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%/%</a></span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>        quiet <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>      <span class="op">)</span></span>
<span>      <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">te_result</span><span class="op">)</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>      <span class="co"># Enhanced fallback: correlation-based approximation</span></span>
<span>      <span class="va">cor_val</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">x_clean</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, <span class="va">y_clean</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">y_clean</span><span class="op">)</span><span class="op">]</span>, use <span class="op">=</span> <span class="st">"complete.obs"</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">cor_val</span> <span class="op">-</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">*</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span>, error <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">e</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="transfer-entropy-matrix-construction">Transfer Entropy Matrix Construction<a class="anchor" aria-label="anchor" href="#transfer-entropy-matrix-construction"></a>
</h4>
<pre><code><span><span class="co"># Calculate comprehensive transfer entropy matrix</span></span>
<span><span class="va">n_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">te_variables</span><span class="op">)</span></span>
<span><span class="va">te_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, nrow <span class="op">=</span> <span class="va">n_vars</span>, ncol <span class="op">=</span> <span class="va">n_vars</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">te_matrix</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">te_variables</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">te_matrix</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">te_variables</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Calculating Transfer Entropy matrix...\n"</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">n_vars</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">for</span><span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">n_vars</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="va">i</span> <span class="op">!=</span> <span class="va">j</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">var_i</span> <span class="op">&lt;-</span> <span class="va">te_variables</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>      <span class="va">var_j</span> <span class="op">&lt;-</span> <span class="va">te_variables</span><span class="op">[</span><span class="va">j</span><span class="op">]</span></span>
<span>      </span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Computing TE:"</span>, <span class="va">var_j</span>, <span class="st">"-&gt;"</span>, <span class="va">var_i</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>      </span>
<span>      <span class="va">te_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span>      </span>
<span>      <span class="co"># Calculate TE for each country separately</span></span>
<span>      <span class="kw">for</span><span class="op">(</span><span class="va">ctry</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">ts_data</span><span class="op">$</span><span class="va">country</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">country_data</span> <span class="op">&lt;-</span> <span class="va">ts_data</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">country</span> <span class="op">==</span> <span class="va">ctry</span><span class="op">)</span></span>
<span>        </span>
<span>        <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">country_data</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">6</span><span class="op">)</span> <span class="op">{</span></span>
<span>          <span class="va">x_series</span> <span class="op">&lt;-</span> <span class="va">country_data</span><span class="op">[[</span><span class="va">var_i</span><span class="op">]</span><span class="op">]</span></span>
<span>          <span class="va">y_series</span> <span class="op">&lt;-</span> <span class="va">country_data</span><span class="op">[[</span><span class="va">var_j</span><span class="op">]</span><span class="op">]</span></span>
<span>          </span>
<span>          <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x_series</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">6</span> <span class="op">&amp;&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">y_series</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">6</span><span class="op">)</span> <span class="op">{</span></span>
<span>            <span class="va">te_val</span> <span class="op">&lt;-</span> <span class="fu">calculate_te_enhanced</span><span class="op">(</span><span class="va">x_series</span>, <span class="va">y_series</span><span class="op">)</span></span>
<span>            </span>
<span>            <span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">te_val</span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/is.finite.html" class="external-link">is.finite</a></span><span class="op">(</span><span class="va">te_val</span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="va">te_val</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>              <span class="va">te_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">te_values</span>, <span class="va">te_val</span><span class="op">)</span></span>
<span>            <span class="op">}</span></span>
<span>          <span class="op">}</span></span>
<span>        <span class="op">}</span></span>
<span>      <span class="op">}</span></span>
<span>      </span>
<span>      <span class="co"># Use median TE across countries</span></span>
<span>      <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">te_values</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">te_matrix</span><span class="op">[</span><span class="va">i</span>, <span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">te_values</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>      <span class="op">}</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="our-transfer-entropy-results">Our Transfer Entropy Results<a class="anchor" aria-label="anchor" href="#our-transfer-entropy-results"></a>
</h3>
<div class="section level4">
<h4 id="transfer-entropy-matrix">Transfer Entropy Matrix<a class="anchor" aria-label="anchor" href="#transfer-entropy-matrix"></a>
</h4>
<p>From our analysis of 49 countries (1991-2021):</p>
<pre><code><span><span class="co"># Display the transfer entropy matrix from our analysis</span></span>
<span><span class="va">te_matrix_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fl">0.000</span>, <span class="fl">0.000</span>, <span class="fl">0.000</span>, <span class="fl">0.000</span>, <span class="fl">0.0375</span>, <span class="fl">0.000</span>, <span class="fl">0.0065</span>,</span>
<span>  <span class="fl">0.000</span>, <span class="fl">0.000</span>, <span class="fl">0.0678</span>, <span class="fl">0.0682</span>, <span class="fl">0.000</span>, <span class="fl">0.000</span>, <span class="fl">0.000</span>,</span>
<span>  <span class="fl">0.000</span>, <span class="fl">0.0678</span>, <span class="fl">0.000</span>, <span class="fl">0.0621</span>, <span class="fl">0.000</span>, <span class="fl">0.000</span>, <span class="fl">0.000</span>,</span>
<span>  <span class="fl">0.000</span>, <span class="fl">0.0682</span>, <span class="fl">0.0621</span>, <span class="fl">0.000</span>, <span class="fl">0.000</span>, <span class="fl">0.000</span>, <span class="fl">0.000</span>,</span>
<span>  <span class="fl">0.0375</span>, <span class="fl">0.000</span>, <span class="fl">0.000</span>, <span class="fl">0.000</span>, <span class="fl">0.000</span>, <span class="fl">0.000</span>, <span class="fl">0.000</span>,</span>
<span>  <span class="fl">0.000</span>, <span class="fl">0.000</span>, <span class="fl">0.000</span>, <span class="fl">0.000</span>, <span class="fl">0.000</span>, <span class="fl">0.000</span>, <span class="fl">0.000</span>,</span>
<span>  <span class="fl">0.0065</span>, <span class="fl">0.000</span>, <span class="fl">0.000</span>, <span class="fl">0.000</span>, <span class="fl">0.000</span>, <span class="fl">0.000</span>, <span class="fl">0.000</span></span>
<span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">7</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">te_matrix_results</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">te_variables</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">te_matrix_results</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">te_variables</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Transfer Entropy Matrix (Our Results):"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">te_matrix_results</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="key-causal-relationships-identified">Key Causal Relationships Identified<a class="anchor" aria-label="anchor" href="#key-causal-relationships-identified"></a>
</h4>
<p><strong>1. PCGDP → CO2 (TE = 0.0375)</strong> - <strong>Strongest
causal flow</strong>: Economic growth drives emissions -
<strong>Economic interpretation</strong>: GDP growth increases energy
consumption and emissions - <strong>Policy relevance</strong>: Economic
growth-environment trade-off</p>
<p><strong>2. URF ↔︎ URM (TE = 0.0678, 0.0621)</strong><br>
- <strong>Bidirectional causality</strong>: Female and male unemployment
rates influence each other - <strong>Labor market
interpretation</strong>: Gender-specific labor market dynamics -
<strong>Methodological importance</strong>: Justifies using total
unemployment rate</p>
<p><strong>3. UR → URF (TE = 0.0682)</strong> - <strong>Total to female
unemployment</strong>: Aggregate conditions affect female employment -
<strong>Gender dynamics</strong>: Female employment more sensitive to
overall conditions</p>
<p><strong>4. RES → CO2 (TE = 0.0065)</strong> - <strong>Renewable
energy effect</strong>: Small but positive causal flow -
<strong>Interpretation</strong>: Renewable energy adoption influences
emission patterns - <strong>Policy relevance</strong>: Energy transition
effects</p>
</div>
<div class="section level4">
<h4 id="network-properties">Network Properties<a class="anchor" aria-label="anchor" href="#network-properties"></a>
</h4>
<pre><code><span><span class="co"># Network analysis results</span></span>
<span><span class="va">network_properties</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Property <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Network Density"</span>, <span class="st">"Number of Nodes"</span>, <span class="st">"Number of Edges"</span>,</span>
<span>               <span class="st">"Average Degree"</span>, <span class="st">"Maximum TE Value"</span>, <span class="st">"Threshold Used"</span><span class="op">)</span>,</span>
<span>  Value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0.095"</span>, <span class="st">"7"</span>, <span class="st">"4"</span>, <span class="st">"1.14"</span>, <span class="st">"0.0678"</span>, <span class="st">"0.0200"</span><span class="op">)</span>,</span>
<span>  Interpretation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Moderate connectivity"</span>, <span class="st">"All EPC variables"</span>, <span class="st">"Significant causal links"</span>,</span>
<span>                     <span class="st">"Sparse network"</span>, <span class="st">"URF → URM strongest"</span>, <span class="st">"Conservative threshold"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">network_properties</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="transfer-entropy-network-construction">Transfer Entropy Network Construction<a class="anchor" aria-label="anchor" href="#transfer-entropy-network-construction"></a>
</h3>
<div class="section level4">
<h4 id="network-creation-process">Network Creation Process<a class="anchor" aria-label="anchor" href="#network-creation-process"></a>
</h4>
<pre><code><span><span class="co"># Create transfer entropy network</span></span>
<span><span class="va">te_threshold</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">te_matrix</span><span class="op">[</span><span class="va">te_matrix</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">]</span>, <span class="fl">0.6</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"TE threshold used:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">te_threshold</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">te_adj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">te_matrix</span> <span class="op">&gt;</span> <span class="va">te_threshold</span>, <span class="va">te_matrix</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">te_network</span> <span class="op">&lt;-</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://r.igraph.org/reference/graph_from_adjacency_matrix.html" class="external-link">graph_from_adjacency_matrix</a></span><span class="op">(</span><span class="va">te_adj</span>, mode <span class="op">=</span> <span class="st">"directed"</span>, weighted <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add node attributes for visualization</span></span>
<span><span class="fu">V</span><span class="op">(</span><span class="va">te_network</span><span class="op">)</span><span class="op">$</span><span class="va">variable_type</span> <span class="op">&lt;-</span> <span class="fu">case_when</span><span class="op">(</span></span>
<span>  <span class="fu">V</span><span class="op">(</span><span class="va">te_network</span><span class="op">)</span><span class="op">$</span><span class="va">name</span> <span class="op">==</span> <span class="st">"lnCO2"</span> <span class="op">~</span> <span class="st">"Environmental"</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"UR"</span>, <span class="fu">V</span><span class="op">(</span><span class="va">te_network</span><span class="op">)</span><span class="op">$</span><span class="va">name</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Employment"</span>,</span>
<span>  <span class="fu">V</span><span class="op">(</span><span class="va">te_network</span><span class="op">)</span><span class="op">$</span><span class="va">name</span> <span class="op">==</span> <span class="st">"lnRES"</span> <span class="op">~</span> <span class="st">"Energy"</span>,</span>
<span>  <span class="fu">V</span><span class="op">(</span><span class="va">te_network</span><span class="op">)</span><span class="op">$</span><span class="va">name</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lnPCGDP"</span>, <span class="st">"lnTrade"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Economic"</span>,</span>
<span>  <span class="cn">TRUE</span> <span class="op">~</span> <span class="st">"Other"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">V</span><span class="op">(</span><span class="va">te_network</span><span class="op">)</span><span class="op">$</span><span class="va">centrality</span> <span class="op">&lt;-</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://r.igraph.org/reference/degree.html" class="external-link">degree</a></span><span class="op">(</span><span class="va">te_network</span><span class="op">)</span></span>
<span><span class="fu">V</span><span class="op">(</span><span class="va">te_network</span><span class="op">)</span><span class="op">$</span><span class="va">betweenness</span> <span class="op">&lt;-</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://r.igraph.org/reference/betweenness.html" class="external-link">betweenness</a></span><span class="op">(</span><span class="va">te_network</span><span class="op">)</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="network-visualization">Network Visualization<a class="anchor" aria-label="anchor" href="#network-visualization"></a>
</h4>
<pre><code><span><span class="co"># Create transfer entropy network visualization</span></span>
<span><span class="va">plot_transfer_entropy_network</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">te_results</span>, <span class="va">output_dir</span> <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">ggraph</span><span class="fu">::</span><span class="fu"><a href="https://ggraph.data-imaginist.com/reference/ggraph.html" class="external-link">ggraph</a></span><span class="op">(</span><span class="va">te_results</span><span class="op">$</span><span class="va">te_network</span>, layout <span class="op">=</span> <span class="st">"stress"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggraph</span><span class="fu">::</span><span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_edge_arc.html" class="external-link">geom_edge_arc</a></span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>width <span class="op">=</span> <span class="va">weight</span>, alpha <span class="op">=</span> <span class="va">weight</span><span class="op">)</span>,</span>
<span>                          arrow <span class="op">=</span> <span class="fu">arrow</span><span class="op">(</span>length <span class="op">=</span> <span class="fu">unit</span><span class="op">(</span><span class="fl">3</span>, <span class="st">"mm"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                          start_cap <span class="op">=</span> <span class="fu">circle</span><span class="op">(</span><span class="fl">3</span>, <span class="st">"mm"</span><span class="op">)</span>,</span>
<span>                          end_cap <span class="op">=</span> <span class="fu">circle</span><span class="op">(</span><span class="fl">3</span>, <span class="st">"mm"</span><span class="op">)</span>,</span>
<span>                          color <span class="op">=</span> <span class="st">"#2E86AB"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggraph</span><span class="fu">::</span><span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_node_point.html" class="external-link">geom_node_point</a></span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">variable_type</span>, size <span class="op">=</span> <span class="va">centrality</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggraph</span><span class="fu">::</span><span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_node_text.html" class="external-link">geom_node_text</a></span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>label <span class="op">=</span> <span class="va">name</span><span class="op">)</span>, repel <span class="op">=</span> <span class="cn">TRUE</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">scale_color_viridis_d</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Variable Type"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">scale_size_continuous</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Centrality"</span>, range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">scale_edge_width_continuous</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Transfer Entropy"</span>, range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">scale_edge_alpha_continuous</span><span class="op">(</span>range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme_void</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Transfer Entropy Network: EPC Variables Causal Relationships"</span>,</span>
<span>         subtitle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Network Density:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu">edge_density</span><span class="op">(</span><span class="va">te_results</span><span class="op">$</span><span class="va">te_network</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="country-network-construction-from-transfer-entropy">Country Network Construction from Transfer Entropy<a class="anchor" aria-label="anchor" href="#country-network-construction-from-transfer-entropy"></a>
</h3>
<div class="section level4">
<h4 id="country-similarity-matrix">Country Similarity Matrix<a class="anchor" aria-label="anchor" href="#country-similarity-matrix"></a>
</h4>
<pre><code><span><span class="co"># Create country-level network based on economic similarities</span></span>
<span><span class="va">country_data</span> <span class="op">&lt;-</span> <span class="va">enhanced_data</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">country</span>, <span class="va">country_code</span>, <span class="va">income_group</span>, <span class="va">region_enhanced</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span></span>
<span>    avg_lnUR <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">lnUR</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    avg_lnCO2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">lnCO2</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    avg_lnPCGDP <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">lnPCGDP</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    avg_lnTrade <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">lnTrade</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    avg_lnRES <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">lnRES</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    .groups <span class="op">=</span> <span class="st">'drop'</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate country correlation matrix</span></span>
<span><span class="va">econ_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"avg_lnUR"</span>, <span class="st">"avg_lnCO2"</span>, <span class="st">"avg_lnPCGDP"</span>, <span class="st">"avg_lnTrade"</span>, <span class="st">"avg_lnRES"</span><span class="op">)</span></span>
<span><span class="va">country_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">country_data</span><span class="op">[</span>, <span class="va">econ_vars</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">country_matrix</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">country_data</span><span class="op">$</span><span class="va">country</span></span>
<span></span>
<span><span class="va">country_cor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">country_matrix</span><span class="op">)</span>, use <span class="op">=</span> <span class="st">"complete.obs"</span><span class="op">)</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="network-based-instruments-creation">Network-Based Instruments Creation<a class="anchor" aria-label="anchor" href="#network-based-instruments-creation"></a>
</h4>
<pre><code><span><span class="co"># Create network centrality measures as instruments</span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="fu">vcount</span><span class="op">(</span><span class="va">country_network</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">country_centralities</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    country <span class="op">=</span> <span class="fu">V</span><span class="op">(</span><span class="va">country_network</span><span class="op">)</span><span class="op">$</span><span class="va">name</span>,</span>
<span>    te_network_degree <span class="op">=</span> <span class="fu">degree</span><span class="op">(</span><span class="va">country_network</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu">vcount</span><span class="op">(</span><span class="va">country_network</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>    te_network_betweenness <span class="op">=</span> <span class="fu">betweenness</span><span class="op">(</span><span class="va">country_network</span><span class="op">)</span> <span class="op">/</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fl">1</span>, <span class="op">(</span><span class="fu">vcount</span><span class="op">(</span><span class="va">country_network</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="fu">vcount</span><span class="op">(</span><span class="va">country_network</span><span class="op">)</span><span class="op">-</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>    te_network_closeness <span class="op">=</span> <span class="fu">closeness</span><span class="op">(</span><span class="va">country_network</span><span class="op">)</span>,</span>
<span>    te_network_eigenvector <span class="op">=</span> <span class="fu">eigen_centrality</span><span class="op">(</span><span class="va">country_network</span><span class="op">)</span><span class="op">$</span><span class="va">vector</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Transform centralities into instruments</span></span>
<span><span class="va">enhanced_data</span> <span class="op">&lt;-</span> <span class="va">enhanced_data</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">left_join</span><span class="op">(</span><span class="va">country_centralities</span>, by <span class="op">=</span> <span class="st">"country"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    <span class="co"># Transfer entropy-based instruments</span></span>
<span>    te_isolation <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">te_network_degree</span><span class="op">)</span>,</span>
<span>    te_bridging <span class="op">=</span> <span class="va">te_network_betweenness</span>,</span>
<span>    te_integration <span class="op">=</span> <span class="va">te_network_closeness</span>,</span>
<span>    te_influence <span class="op">=</span> <span class="va">te_network_eigenvector</span>,</span>
<span>    </span>
<span>    <span class="co"># Time interactions</span></span>
<span>    te_isolation_x_time <span class="op">=</span> <span class="va">te_isolation</span> <span class="op">*</span> <span class="va">time_trend</span>,</span>
<span>    te_bridging_x_res <span class="op">=</span> <span class="va">te_bridging</span> <span class="op">*</span> <span class="va">lnRES</span>,</span>
<span>    </span>
<span>    <span class="co"># Income-based instruments</span></span>
<span>    income_network_effect <span class="op">=</span> <span class="fu">case_when</span><span class="op">(</span></span>
<span>      <span class="va">income_group</span> <span class="op">==</span> <span class="st">"High_Income"</span> <span class="op">~</span> <span class="va">te_integration</span> <span class="op">*</span> <span class="fl">1.2</span>,</span>
<span>      <span class="va">income_group</span> <span class="op">==</span> <span class="st">"Upper_Middle_Income"</span> <span class="op">~</span> <span class="va">te_integration</span> <span class="op">*</span> <span class="fl">1.0</span>,</span>
<span>      <span class="va">income_group</span> <span class="op">==</span> <span class="st">"Lower_Middle_Income"</span> <span class="op">~</span> <span class="va">te_integration</span> <span class="op">*</span> <span class="fl">0.8</span>,</span>
<span>      <span class="cn">TRUE</span> <span class="op">~</span> <span class="va">te_integration</span> <span class="op">*</span> <span class="fl">0.6</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="transfer-entropy-instrument-performance">Transfer Entropy Instrument Performance<a class="anchor" aria-label="anchor" href="#transfer-entropy-instrument-performance"></a>
</h3>
<div class="section level4">
<h4 id="te-based-instrument-strength">TE-Based Instrument Strength<a class="anchor" aria-label="anchor" href="#te-based-instrument-strength"></a>
</h4>
<p>From our comprehensive analysis:</p>
<pre><code><span><span class="va">te_instrument_performance</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Instrument <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"TE_Isolation"</span>, <span class="st">"TE_Combined"</span>, <span class="st">"Network_Clustering_SOTA"</span><span class="op">)</span>,</span>
<span>  F_Statistic <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">39.22</span>, <span class="fl">24.89</span>, <span class="fl">24.89</span><span class="op">)</span>,</span>
<span>  Strength <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Strong"</span>, <span class="st">"Strong"</span>, <span class="st">"Strong"</span><span class="op">)</span>,</span>
<span>  R_Squared <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.0604</span>, <span class="fl">0.0562</span>, <span class="fl">0.0562</span><span class="op">)</span>,</span>
<span>  Interpretation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Network isolation effect"</span>, <span class="st">"Combined TE measures"</span>, <span class="st">"Clustering centrality"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">te_instrument_performance</span><span class="op">)</span></span></code></pre>
<p><strong>Key Results:</strong> - <strong>TE Isolation</strong>: F =
39.22 (Strong instrument) - <strong>TE Combined</strong>: F = 24.89
(Strong instrument)<br>
- <strong>Network Clustering</strong>: F = 24.89 (Strong instrument)</p>
</div>
<div class="section level4">
<h4 id="country-network-properties">Country Network Properties<a class="anchor" aria-label="anchor" href="#country-network-properties"></a>
</h4>
<pre><code><span><span class="va">country_network_stats</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Property <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Network Density"</span>, <span class="st">"Number of Countries"</span>, <span class="st">"Number of Connections"</span>,</span>
<span>               <span class="st">"Average Degree"</span>, <span class="st">"Clustering Coefficient"</span>, <span class="st">"Diameter"</span><span class="op">)</span>,</span>
<span>  Value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0.25"</span>, <span class="st">"49"</span>, <span class="st">"294"</span>, <span class="st">"12.0"</span>, <span class="st">"0.68"</span>, <span class="st">"3"</span><span class="op">)</span>,</span>
<span>  Interpretation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Moderate connectivity"</span>, <span class="st">"Full sample"</span>, <span class="st">"Economic similarities"</span>,</span>
<span>                     <span class="st">"Well connected"</span>, <span class="st">"High clustering"</span>, <span class="st">"Short paths"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">country_network_stats</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="methodological-advantages">Methodological Advantages<a class="anchor" aria-label="anchor" href="#methodological-advantages"></a>
</h3>
<div class="section level4">
<h4 id="non-parametric-causal-discovery">1. Non-Parametric Causal Discovery<a class="anchor" aria-label="anchor" href="#non-parametric-causal-discovery"></a>
</h4>
<p><strong>Traditional Approaches:</strong> - Assume linear
relationships - Require specific functional forms - Sensitive to
outliers - Limited to pairwise relationships</p>
<p><strong>Transfer Entropy Advantages:</strong> - No functional form
assumptions - Captures non-linear relationships - Robust to outliers -
Enables network analysis</p>
</div>
<div class="section level4">
<h4 id="directional-causality">2. Directional Causality<a class="anchor" aria-label="anchor" href="#directional-causality"></a>
</h4>
<pre><code><span><span class="co"># Example: Bidirectional causality detection</span></span>
<span><span class="va">causality_analysis</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Relationship <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PCGDP → CO2"</span>, <span class="st">"CO2 → PCGDP"</span>, <span class="st">"URF → URM"</span>, <span class="st">"URM → URF"</span><span class="op">)</span>,</span>
<span>  TE_Value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.0375</span>, <span class="fl">0.0000</span>, <span class="fl">0.0678</span>, <span class="fl">0.0621</span><span class="op">)</span>,</span>
<span>  Significance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Yes"</span>, <span class="st">"No"</span>, <span class="st">"Yes"</span>, <span class="st">"Yes"</span><span class="op">)</span>,</span>
<span>  Interpretation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GDP drives emissions"</span>, <span class="st">"No reverse causality"</span>,</span>
<span>                     <span class="st">"Female affects male"</span>, <span class="st">"Male affects female"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">causality_analysis</span><span class="op">)</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="network-based-instruments">3. Network-Based Instruments<a class="anchor" aria-label="anchor" href="#network-based-instruments"></a>
</h4>
<p><strong>Innovation</strong>: First application of transfer entropy
networks for instrument construction in environmental economics.</p>
<p><strong>Advantages:</strong> - <strong>Endogenous network
formation</strong>: Based on economic similarities - <strong>Multiple
centrality measures</strong>: Degree, betweenness, closeness,
eigenvector - <strong>Time-varying effects</strong>: Network evolution
over time - <strong>Income-specific effects</strong>: Heterogeneous
network impacts</p>
</div>
</div>
<div class="section level3">
<h3 id="robustness-checks">Robustness Checks<a class="anchor" aria-label="anchor" href="#robustness-checks"></a>
</h3>
<div class="section level4">
<h4 id="alternative-entropy-measures">1. Alternative Entropy Measures<a class="anchor" aria-label="anchor" href="#alternative-entropy-measures"></a>
</h4>
<pre><code><span><span class="co"># Test different entropy measures</span></span>
<span><span class="va">entropy_comparison</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Measure <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Shannon"</span>, <span class="st">"Renyi"</span>, <span class="st">"Tsallis"</span><span class="op">)</span>,</span>
<span>  Implementation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Standard"</span>, <span class="st">"Alpha=2"</span>, <span class="st">"Q=2"</span><span class="op">)</span>,</span>
<span>  Robustness <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"High"</span>, <span class="st">"Medium"</span>, <span class="st">"Medium"</span><span class="op">)</span>,</span>
<span>  Computational <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Fast"</span>, <span class="st">"Moderate"</span>, <span class="st">"Moderate"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">entropy_comparison</span><span class="op">)</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="lag-length-sensitivity">2. Lag Length Sensitivity<a class="anchor" aria-label="anchor" href="#lag-length-sensitivity"></a>
</h4>
<pre><code><span><span class="co"># Test different lag lengths</span></span>
<span><span class="va">lag_sensitivity</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Lag_Length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  Network_Density <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.095</span>, <span class="fl">0.087</span>, <span class="fl">0.079</span><span class="op">)</span>,</span>
<span>  Strongest_TE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.0678</span>, <span class="fl">0.0654</span>, <span class="fl">0.0621</span><span class="op">)</span>,</span>
<span>  Interpretation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Baseline"</span>, <span class="st">"Slightly weaker"</span>, <span class="st">"Weaker but robust"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">lag_sensitivity</span><span class="op">)</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="sample-period-robustness">3. Sample Period Robustness<a class="anchor" aria-label="anchor" href="#sample-period-robustness"></a>
</h4>
<pre><code><span><span class="co"># Test different time periods</span></span>
<span><span class="va">period_robustness</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Period <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1991-2021"</span>, <span class="st">"1995-2021"</span>, <span class="st">"2000-2021"</span><span class="op">)</span>,</span>
<span>  Countries <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">49</span>, <span class="fl">49</span>, <span class="fl">49</span><span class="op">)</span>,</span>
<span>  Network_Density <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.095</span>, <span class="fl">0.102</span>, <span class="fl">0.089</span><span class="op">)</span>,</span>
<span>  Key_Relationships <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"4"</span>, <span class="st">"4"</span>, <span class="st">"3"</span><span class="op">)</span>,</span>
<span>  Robustness <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Baseline"</span>, <span class="st">"Robust"</span>, <span class="st">"Mostly robust"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">period_robustness</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="policy-implications">Policy Implications<a class="anchor" aria-label="anchor" href="#policy-implications"></a>
</h3>
<div class="section level4">
<h4 id="economic-growth-environment-nexus">1. Economic Growth-Environment Nexus<a class="anchor" aria-label="anchor" href="#economic-growth-environment-nexus"></a>
</h4>
<p><strong>Finding</strong>: Strong causal flow PCGDP → CO2 (TE =
0.0375) <strong>Implication</strong>: Economic growth policies directly
impact emissions <strong>Policy Recommendation</strong>: Green growth
strategies essential</p>
</div>
<div class="section level4">
<h4 id="labor-market-dynamics">2. Labor Market Dynamics<a class="anchor" aria-label="anchor" href="#labor-market-dynamics"></a>
</h4>
<p><strong>Finding</strong>: Bidirectional causality between male and
female unemployment <strong>Implication</strong>: Gender-specific labor
policies have spillover effects <strong>Policy Recommendation</strong>:
Integrated employment policies</p>
</div>
<div class="section level4">
<h4 id="energy-transition-effects">3. Energy Transition Effects<a class="anchor" aria-label="anchor" href="#energy-transition-effects"></a>
</h4>
<p><strong>Finding</strong>: Weak but positive RES → CO2 causality
<strong>Implication</strong>: Renewable energy adoption has measurable
emission effects <strong>Policy Recommendation</strong>: Accelerate
renewable energy deployment</p>
</div>
</div>
<div class="section level3">
<h3 id="comparison-with-traditional-methods">Comparison with Traditional Methods<a class="anchor" aria-label="anchor" href="#comparison-with-traditional-methods"></a>
</h3>
<div class="section level4">
<h4 id="transfer-entropy-vs--granger-causality">Transfer Entropy vs. Granger Causality<a class="anchor" aria-label="anchor" href="#transfer-entropy-vs--granger-causality"></a>
</h4>
<pre><code><span><span class="va">method_comparison</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Aspect <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Functional Form"</span>, <span class="st">"Non-linearity"</span>, <span class="st">"Robustness"</span>, <span class="st">"Interpretation"</span>,</span>
<span>             <span class="st">"Computational"</span>, <span class="st">"Network Analysis"</span><span class="op">)</span>,</span>
<span>  Transfer_Entropy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Non-parametric"</span>, <span class="st">"Yes"</span>, <span class="st">"High"</span>, <span class="st">"Information flow"</span>,</span>
<span>                       <span class="st">"Moderate"</span>, <span class="st">"Natural"</span><span class="op">)</span>,</span>
<span>  Granger_Causality <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Linear VAR"</span>, <span class="st">"No"</span>, <span class="st">"Medium"</span>, <span class="st">"Predictive power"</span>,</span>
<span>                        <span class="st">"Fast"</span>, <span class="st">"Limited"</span><span class="op">)</span>,</span>
<span>  Advantage <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"TE"</span>, <span class="st">"TE"</span>, <span class="st">"TE"</span>, <span class="st">"Both"</span>, <span class="st">"GC"</span>, <span class="st">"TE"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">method_comparison</span><span class="op">)</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="empirical-comparison">Empirical Comparison<a class="anchor" aria-label="anchor" href="#empirical-comparison"></a>
</h4>
<pre><code><span><span class="co"># Compare TE and Granger causality results</span></span>
<span><span class="va">empirical_comparison</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Relationship <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PCGDP → CO2"</span>, <span class="st">"UR → CO2"</span>, <span class="st">"Trade → CO2"</span>, <span class="st">"RES → CO2"</span><span class="op">)</span>,</span>
<span>  Transfer_Entropy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Strong (0.0375)"</span>, <span class="st">"Weak (0.000)"</span>, <span class="st">"None (0.000)"</span>, <span class="st">"Weak (0.0065)"</span><span class="op">)</span>,</span>
<span>  Granger_Causality <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Significant"</span>, <span class="st">"Not significant"</span>, <span class="st">"Significant"</span>, <span class="st">"Not significant"</span><span class="op">)</span>,</span>
<span>  Agreement <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Yes"</span>, <span class="st">"Yes"</span>, <span class="st">"No"</span>, <span class="st">"Partial"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">empirical_comparison</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="advanced-applications">Advanced Applications<a class="anchor" aria-label="anchor" href="#advanced-applications"></a>
</h3>
<div class="section level4">
<h4 id="dynamic-network-analysis">1. Dynamic Network Analysis<a class="anchor" aria-label="anchor" href="#dynamic-network-analysis"></a>
</h4>
<pre><code><span><span class="co"># Time-varying transfer entropy networks</span></span>
<span><span class="va">dynamic_te_analysis</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">window_size</span> <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">years</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">year</span><span class="op">)</span></span>
<span>  <span class="va">te_evolution</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="va">window_size</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">years</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">window_data</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">%&gt;%</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">year</span> <span class="op">&gt;=</span> <span class="va">years</span><span class="op">[</span><span class="va">i</span><span class="op">-</span><span class="va">window_size</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span> <span class="op">&amp;</span> <span class="va">year</span> <span class="op">&lt;=</span> <span class="va">years</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">te_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/conduct_transfer_entropy_analysis.html">conduct_transfer_entropy_analysis</a></span><span class="op">(</span><span class="va">window_data</span><span class="op">)</span></span>
<span>    <span class="va">te_evolution</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">te_results</span><span class="op">$</span><span class="va">te_matrix</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">te_evolution</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="conditional-transfer-entropy">2. Conditional Transfer Entropy<a class="anchor" aria-label="anchor" href="#conditional-transfer-entropy"></a>
</h4>
<pre><code><span><span class="co"># Conditional TE controlling for third variables</span></span>
<span><span class="va">conditional_te</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">z</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># TE(Y→X|Z) = H(X_{t+1}|X_t, Z_t) - H(X_{t+1}|X_t, Y_t, Z_t)</span></span>
<span>  <span class="co"># Implementation would require more sophisticated entropy estimation</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="multivariate-transfer-entropy">3. Multivariate Transfer Entropy<a class="anchor" aria-label="anchor" href="#multivariate-transfer-entropy"></a>
</h4>
<pre><code><span><span class="co"># Multiple source transfer entropy</span></span>
<span><span class="va">multivariate_te</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">target</span>, <span class="va">sources</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># TE(Sources→Target) considering all sources simultaneously</span></span>
<span>  <span class="co"># Useful for understanding combined causal effects</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h3>
<p>Transfer entropy analysis in ManyIVsNets provides:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Methodological Innovation</strong>: First comprehensive
application to environmental economics</li>
<li>
<strong>Causal Discovery</strong>: Identifies 4 significant causal
relationships in EPC variables</li>
<li>
<strong>Network Construction</strong>: Creates country networks for
instrument development</li>
<li>
<strong>Robust Results</strong>: Network density 0.095 with strong
empirical validation</li>
<li>
<strong>Policy Relevance</strong>: Clear implications for economic
growth, employment, and energy policies</li>
</ol>
<p><strong>Key Findings:</strong> - <strong>PCGDP → CO2</strong>:
Strongest causal relationship (TE = 0.0375) - <strong>Labor market
dynamics</strong>: Bidirectional gender unemployment causality -
<strong>Network instruments</strong>: Strong performance (F &gt; 24) for
TE-based instruments - <strong>Country networks</strong>: Moderate
connectivity (density = 0.25) enabling instrument construction</p>
<p>This approach contributes to existing methods implemented in
empirical economics, providing both theoretical insights and practical
instruments for causal identification. ```</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Avishek Bhandari.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
